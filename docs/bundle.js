(()=>{"use strict";class t{constructor(t){this.name=t,this.inventory=new Set}addItem(t){this.inventory.add(t)}}var e,i,s,n,a=function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i},r=function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)};class o{constructor(){e.set(this,void 0),i.set(this,void 0),s.set(this,void 0),n.set(this,void 0),a(this,e,"","f"),a(this,i,1,"f"),a(this,s,document.createElement("div"),"f"),a(this,n,document.createElement("p"),"f")}setup(t){r(this,s,"f").className="hintBoxContainer",r(this,n,"f").className="hintTextContainer",r(this,s,"f").appendChild(r(this,n,"f")),t.appendChild(r(this,s,"f"))}setHint(t){a(this,e,t,"f")}draw(){console.log("hint",r(this,e,"f")),r(this,n,"f").innerHTML=r(this,e,"f"),r(this,s,"f").style.display="block"}clear(){r(this,s,"f").style.display="none"}}e=new WeakMap,i=new WeakMap,s=new WeakMap,n=new WeakMap;var h,l,c,d,f,m,w,p,u,v,y,E=function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i},g=function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)};class k{constructor(t,e,i){h.add(this),l.set(this,void 0),c.set(this,void 0),d.set(this,void 0),f.set(this,void 0),m.set(this,void 0),w.set(this,void 0),p.set(this,void 0),E(this,m,i,"f"),E(this,c,i[0],"f"),E(this,d,i[0],"f"),E(this,l,e,"f"),E(this,f,new o,"f"),E(this,w,t,"f"),E(this,p,document.createElement("div"),"f")}start(){this.setup(),g(this,h,"m",y).call(this)}checkHintShouldBeDisplayed(){return g(this,c,"f").hintShouldBeDisplayed}setup(){g(this,p,"f").className="sceneHandlerContainer",g(this,f,"f").setup(g(this,p,"f")),g(this,f,"f").setHint(g(this,c,"f").hint),window.addEventListener("sceneChange",(t=>{console.log("changeScene",t);const e=g(this,m,"f").find((e=>e.id===t.sceneRef))||g(this,c,"f");g(this,h,"m",v).call(this,e)})),window.addEventListener("itemPick",(t=>{console.log("itemPicked",t),g(this,h,"m",u).call(this,t.itemRef)}))}}l=new WeakMap,c=new WeakMap,d=new WeakMap,f=new WeakMap,m=new WeakMap,w=new WeakMap,p=new WeakMap,h=new WeakSet,u=function(t){g(this,c,"f").removeItem(t,g(this,p,"f")),g(this,l,"f").addItem(t)},v=function(t){E(this,d,g(this,c,"f"),"f"),E(this,c,t,"f"),g(this,f,"f").clear(),g(this,d,"f").clear(g(this,p,"f")),g(this,h,"m",y).call(this)},y=function(){var t;const e=`url(${null===(t=g(this,c,"f"))||void 0===t?void 0:t.background})`;g(this,p,"f").style.setProperty("background-image",e),g(this,p,"f").style.setProperty("background-repeat","no-repeat"),g(this,c,"f").draw(g(this,p,"f")),this.checkHintShouldBeDisplayed()&&g(this,f,"f").draw(),g(this,w,"f").appendChild(g(this,p,"f"))};class b extends Event{constructor(){super("gameStart",{cancelable:!0})}}var T,M,W,C,P,j=function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i},x=function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)};class S{constructor(t,e){T.set(this,void 0),M.set(this,void 0),W.set(this,void 0),C.set(this,void 0),P.set(this,void 0),j(this,T,t,"f"),j(this,M,e,"f"),j(this,W,document.createElement("div"),"f"),j(this,C,document.createElement("p"),"f"),j(this,P,document.createElement("button"),"f")}setup(){x(this,C,"f").className="startMessageContent",x(this,C,"f").innerHTML=x(this,T,"f"),x(this,W,"f").className="startMessageContainer",x(this,P,"f").className="startButton",x(this,P,"f").innerHTML="Enter the Darkness",x(this,P,"f").addEventListener("click",(()=>{window.dispatchEvent(new b)}))}draw(){x(this,W,"f").appendChild(x(this,C,"f")),x(this,W,"f").appendChild(x(this,P,"f")),x(this,M,"f").appendChild(x(this,W,"f"))}}T=new WeakMap,M=new WeakMap,W=new WeakMap,C=new WeakMap,P=new WeakMap;var N,$,D,L,B,H,I=function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i},O=function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)};class _{constructor(t,e,i){N.add(this),$.set(this,void 0),D.set(this,void 0),L.set(this,void 0),B.set(this,void 0),I(this,D,i,"f"),I(this,L,t,"f"),I(this,$,document.createElement("div"),"f"),I(this,B,new S(e,O(this,$,"f")),"f")}draw(){O(this,N,"m",H).call(this),O(this,D,"f").appendChild(O(this,$,"f")),O(this,B,"f").draw()}clear(){O(this,D,"f").replaceChildren()}}$=new WeakMap,D=new WeakMap,L=new WeakMap,B=new WeakMap,N=new WeakSet,H=function(){O(this,$,"f").className="startContainer",O(this,$,"f").style.setProperty("background-image",'url("https://res.cloudinary.com/dcgbmo9ov/image/upload/v1664213892/EnterDarknessGallery/Backgrounds/forestmansion2_tlze3v.jpg")'),O(this,$,"f").style.setProperty("background-repeat","no-repeat"),O(this,B,"f").setup()};const A=JSON.parse('{"N":[{"id":"hall","hint":"La puerta estaba abierta, todas las luces están encendidas pero no veo a nadie. Sin embargo, noto una presencia... Será mejor que me de prisa","background":"https://res.cloudinary.com/dcgbmo9ov/image/upload/v1664213751/EnterDarknessGallery/Scenes/hall5_m4cgzc.jpg","paths":[{"x":45,"y":45,"width":10,"height":24,"to":"statue"}],"actions":[{"x":15,"y":45,"width":10,"height":24,"condition":"goldenkey","id":"unlock_door"}],"items":[{"x":55,"y":45,"width":5,"height":15,"item":"goldenkey","img":"https://res.cloudinary.com/dcgbmo9ov/image/upload/v1664213923/EnterDarknessGallery/Items/goldkey_eio26f.png"}]},{"id":"statue","background":"https://res.cloudinary.com/dcgbmo9ov/image/upload/v1664213754/EnterDarknessGallery/Scenes/statue2_ed7nec.jpg","paths":[{"x":35,"y":25,"width":10,"height":24,"to":"hall"}]}]}');class G extends Event{constructor(t){super("action",{cancelable:!0}),this.action=t}}class R{constructor(t,e,i,s){this.x=t,this.y=e,this.width=i,this.height=s,this.htmlElement=document.createElement("div")}draw(t){t.appendChild(this.htmlElement)}clear(t){t.removeChild(this.htmlElement)}}class z extends R{constructor(t,e,i,s,n,a){super(t,e,i,s),this.condition=n,this.id=a}setup(){this.htmlElement.style.position="absolute",this.htmlElement.style.cursor="pointer",this.htmlElement.style.right=`${this.x}%`,this.htmlElement.style.top=`${this.y}%`,this.htmlElement.style.width=`${this.width}vw`,this.htmlElement.style.height=`${this.height}vh`,this.htmlElement.className="pathObject",this.htmlElement.addEventListener("click",(t=>{t.preventDefault(),window.dispatchEvent(new G({condition:this.condition,id:this.id}))}))}}class J extends Event{constructor(t){super("itemPick",{cancelable:!0}),this.itemRef=t}}class q extends R{constructor(t,e,i,s,n,a){super(t,e,i,s),this.item=n,this.img=a}setup(){this.htmlElement.style.position="absolute",this.htmlElement.style.cursor="pointer",this.htmlElement.style.right=`${this.x}%`,this.htmlElement.style.top=`${this.y}%`,this.htmlElement.style.width=`${this.width}vw`,this.htmlElement.style.height=`${this.height}vh`,this.htmlElement.style.backgroundImage=`url(${this.img})`,this.htmlElement.className="itemObject",this.htmlElement.addEventListener("click",(t=>{t.preventDefault(),window.dispatchEvent(new J(this.item))}))}}class F extends Event{constructor(t){super("sceneChange",{cancelable:!0}),this.sceneRef=t}}class K extends R{constructor(t,e,i,s,n){super(t,e,i,s),this.to=n}setup(){this.htmlElement.style.position="absolute",this.htmlElement.style.cursor="pointer",this.htmlElement.style.right=`${this.x}%`,this.htmlElement.style.top=`${this.y}%`,this.htmlElement.style.width=`${this.width}vw`,this.htmlElement.style.height=`${this.height}vh`,this.htmlElement.className="pathObject",this.htmlElement.addEventListener("click",(t=>{t.preventDefault(),window.dispatchEvent(new F(this.to))}))}}var Q,U,V,X,Y,Z,tt,et,it=function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)},st=function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i};class nt{constructor(t,e,i,s,n,a){Q.add(this),U.set(this,void 0),V.set(this,void 0),X.set(this,void 0),this.id=t,this.background=e,this.paths=i,this.items=s,this.actions=n,this.hint=a||"",this.hintShouldBeDisplayed=Boolean(a),st(this,U,it(this,Q,"m",Z).call(this),"f"),st(this,V,it(this,Q,"m",tt).call(this),"f"),st(this,X,it(this,Q,"m",Y).call(this),"f")}removeItem(t,e){var i,s;const n=null===(i=it(this,V,"f"))||void 0===i?void 0:i.find((e=>e.item===t));if(!n)return;e.removeChild(n.htmlElement);const a=null===(s=it(this,V,"f"))||void 0===s?void 0:s.indexOf(n),r=JSON.parse(JSON.stringify(it(this,V,"f")));r.splice(a,1),st(this,V,r,"f")}checkArrayEmpty(t){return!t||t.length<=0}clear(t){it(this,U,"f").forEach((e=>{e.clear(t)})),this.checkArrayEmpty(it(this,V,"f"))||it(this,V,"f").forEach((e=>{console.log(e),t.contains(e.htmlElement)&&e.clear(t)}))}draw(t){it(this,Q,"m",et).call(this,it(this,U,"f"),t),it(this,Q,"m",et).call(this,it(this,V,"f"),t),it(this,Q,"m",et).call(this,it(this,X,"f"),t)}}U=new WeakMap,V=new WeakMap,X=new WeakMap,Q=new WeakSet,Y=function(){if(this.checkArrayEmpty(this.actions))return[];const t=[];return this.actions.forEach((e=>{const i=new z(e.x,e.y,e.width,e.height,e.condition,e.id);i.setup(),t.push(i)})),t},Z=function(){if(this.checkArrayEmpty(this.paths))return[];const t=[];return this.paths.forEach((e=>{const i=new K(e.x,e.y,e.width,e.height,e.to);i.setup(),t.push(i)})),t},tt=function(){if(this.checkArrayEmpty(this.items))return[];const t=[];return this.items.forEach((e=>{const i=new q(e.x,e.y,e.width,e.height,e.item,e.img);i.setup(),t.push(i)})),console.log("newItems",Object.assign({},t)),t},et=function(t,e){!t||t.length<=0||t.forEach((t=>{e.appendChild(t.htmlElement)}))};var at,rt,ot,ht,lt,ct,dt,ft,mt=function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i},wt=function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)};class pt{constructor(e){at.add(this),rt.set(this,void 0),ot.set(this,void 0),ht.set(this,void 0),lt.set(this,void 0),mt(this,rt,new t("Marc"),"f"),mt(this,ot,e,"f"),mt(this,ht,new k(e,wt(this,rt,"f"),wt(this,at,"m",ct).call(this)),"f")}init(){console.log("player",wt(this,rt,"f")),wt(this,at,"m",dt).call(this),window.addEventListener("gameStart",(t=>{t.preventDefault(),wt(this,lt,"f").clear(),wt(this,at,"m",ft).call(this)}))}}rt=new WeakMap,ot=new WeakMap,ht=new WeakMap,lt=new WeakMap,at=new WeakSet,ct=function(){return A.N.map((t=>new nt(t.id,t.background,t.paths,t.items||[],t.actions||[],t.hint||"")))},dt=function(){mt(this,lt,new _("https://img.freepik.com/free-vector/colorful-palm-silhouettes-background_23-2148541792.jpg?w=2000","Test Message",wt(this,ot,"f")),"f"),wt(this,lt,"f").draw()},ft=function(){wt(this,ht,"f").start()},window.addEventListener("load",(()=>{const[t,e]=function(){const t=document.getElementById("main")||document.createElement("main");"main"!==t.id&&(t.id="main");const e=document.getElementById("overlay")||document.createElement("div");return"overlay"!==e.id&&(e.id="overlay"),[t,e]}();!function(t,e){const i=window.innerHeight>window.innerWidth;let s=!1;i?null==e||e.style.setProperty("display","block"):(null==e||e.style.setProperty("display","none"),t.init(),s=!0),window.addEventListener("resize",(i=>{window.innerHeight>window.innerWidth?null==e||e.style.setProperty("display","block"):(null==e||e.style.setProperty("display","none"),s||(t.init(),s=!0))}))}(new pt(t),e)}))})();
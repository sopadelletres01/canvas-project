(()=>{"use strict";class t{constructor(t){this.name=t,this.inventory=new Set}addItem(t){this.inventory.add(t)}}var e,i,s,n,a=function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i},r=function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)};class o{constructor(){e.set(this,void 0),i.set(this,void 0),s.set(this,void 0),n.set(this,void 0),a(this,e,"","f"),a(this,i,1,"f"),a(this,s,document.createElement("div"),"f"),a(this,n,document.createElement("p"),"f")}setup(t){r(this,s,"f").className="hintBoxContainer",r(this,n,"f").className="hintTextContainer",r(this,s,"f").appendChild(r(this,n,"f")),t.appendChild(r(this,s,"f"))}setHint(t){a(this,e,t,"f")}draw(){console.log("hint",r(this,e,"f")),r(this,n,"f").innerHTML=r(this,e,"f"),r(this,s,"f").style.display="block"}clear(){r(this,s,"f").style.display="none"}}e=new WeakMap,i=new WeakMap,s=new WeakMap,n=new WeakMap;var h,l,c,d,f,m,w,p,u,v,y,E=function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i},g=function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)};class k{constructor(t,e,i){h.add(this),l.set(this,void 0),c.set(this,void 0),d.set(this,void 0),f.set(this,void 0),m.set(this,void 0),w.set(this,void 0),p.set(this,void 0),E(this,m,i,"f"),E(this,c,i[0],"f"),E(this,d,i[0],"f"),E(this,l,e,"f"),E(this,f,new o,"f"),E(this,w,t,"f"),E(this,p,document.createElement("div"),"f")}start(){this.setup(),g(this,h,"m",y).call(this)}checkHintShouldBeDisplayed(){return g(this,c,"f").hintShouldBeDisplayed}setup(){g(this,p,"f").className="sceneHandlerContainer",g(this,f,"f").setup(g(this,p,"f")),g(this,f,"f").setHint(g(this,c,"f").hint),window.addEventListener("sceneChange",(t=>{console.log("changeScene",t);const e=g(this,m,"f").find((e=>e.id===t.sceneRef))||g(this,c,"f");g(this,h,"m",v).call(this,e)})),window.addEventListener("itemPick",(t=>{console.log("itemPicked",t),g(this,h,"m",u).call(this,t.itemRef)}))}}l=new WeakMap,c=new WeakMap,d=new WeakMap,f=new WeakMap,m=new WeakMap,w=new WeakMap,p=new WeakMap,h=new WeakSet,u=function(t){g(this,c,"f").removeItem(t,g(this,p,"f")),g(this,l,"f").addItem(t)},v=function(t){E(this,d,g(this,c,"f"),"f"),E(this,c,t,"f"),g(this,f,"f").clear(),g(this,d,"f").clear(g(this,p,"f")),g(this,h,"m",y).call(this)},y=function(){var t;const e=`url(${null===(t=g(this,c,"f"))||void 0===t?void 0:t.background})`;g(this,p,"f").style.setProperty("background-image",e),g(this,p,"f").style.setProperty("background-repeat","no-repeat"),g(this,c,"f").draw(g(this,p,"f")),this.checkHintShouldBeDisplayed()&&g(this,f,"f").draw(),g(this,w,"f").appendChild(g(this,p,"f"))};class b extends Event{constructor(){super("gameStart",{cancelable:!0})}}var T,C,M,W,P,j=function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i},S=function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)};class x{constructor(t,e){T.set(this,void 0),C.set(this,void 0),M.set(this,void 0),W.set(this,void 0),P.set(this,void 0),j(this,T,t,"f"),j(this,C,e,"f"),j(this,M,document.createElement("div"),"f"),j(this,W,document.createElement("p"),"f"),j(this,P,document.createElement("button"),"f")}setup(){S(this,W,"f").className="startMessageContent",S(this,W,"f").innerHTML=S(this,T,"f"),S(this,M,"f").className="startMessageContainer",S(this,P,"f").className="startButton",S(this,P,"f").innerHTML="Enter the Darkness",S(this,P,"f").addEventListener("click",(()=>{window.dispatchEvent(new b)}))}draw(){S(this,M,"f").appendChild(S(this,W,"f")),S(this,M,"f").appendChild(S(this,P,"f")),S(this,C,"f").appendChild(S(this,M,"f"))}}T=new WeakMap,C=new WeakMap,M=new WeakMap,W=new WeakMap,P=new WeakMap;var N,D,I,L,B,H,$=function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i},O=function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)};class _{constructor(t,e,i){N.add(this),D.set(this,void 0),I.set(this,void 0),L.set(this,void 0),B.set(this,void 0),$(this,I,i,"f"),$(this,L,t,"f"),$(this,D,document.createElement("div"),"f"),$(this,B,new x(e,O(this,D,"f")),"f")}draw(){O(this,N,"m",H).call(this),O(this,I,"f").appendChild(O(this,D,"f")),O(this,B,"f").draw()}clear(){O(this,I,"f").replaceChildren()}}D=new WeakMap,I=new WeakMap,L=new WeakMap,B=new WeakMap,N=new WeakSet,H=function(){O(this,D,"f").className="startContainer",O(this,D,"f").style.setProperty("background-image",'url("https://res.cloudinary.com/dcgbmo9ov/image/upload/v1664213892/EnterDarknessGallery/Backgrounds/forestmansion2_tlze3v.jpg")'),O(this,D,"f").style.setProperty("background-repeat","no-repeat"),O(this,B,"f").setup()};const G=JSON.parse('{"N":[{"id":"hall","hint":"La puerta estaba abierta, todas las luces están encendidas pero no veo a nadie. Sin embargo, noto una presencia... Será mejor que me de prisa","background":"https://res.cloudinary.com/dcgbmo9ov/image/upload/v1664213751/EnterDarknessGallery/Scenes/hall5_m4cgzc.jpg","paths":[{"x":45,"y":45,"width":10,"height":24,"to":"statue"}],"items":[{"x":55,"y":45,"width":5,"height":15,"item":"goldenkey","img":"https://res.cloudinary.com/dcgbmo9ov/image/upload/v1664213923/EnterDarknessGallery/Items/goldkey_eio26f.png"}]},{"id":"statue","background":"https://res.cloudinary.com/dcgbmo9ov/image/upload/v1664213754/EnterDarknessGallery/Scenes/statue2_ed7nec.jpg","paths":[{"x":35,"y":25,"width":10,"height":24,"to":"hall"}]}]}');class R extends Event{constructor(t){super("itemPick",{cancelable:!0}),this.itemRef=t}}class z{constructor(t,e,i,s){this.x=t,this.y=e,this.width=i,this.height=s,this.htmlElement=document.createElement("div")}draw(t){t.appendChild(this.htmlElement)}clear(t){t.removeChild(this.htmlElement)}}class A extends z{constructor(t,e,i,s,n,a){super(t,e,i,s),this.item=n,this.img=a}setup(){this.htmlElement.style.position="absolute",this.htmlElement.style.cursor="pointer",this.htmlElement.style.right=`${this.x}%`,this.htmlElement.style.top=`${this.y}%`,this.htmlElement.style.width=`${this.width}vw`,this.htmlElement.style.height=`${this.height}vh`,this.htmlElement.style.backgroundImage=`url(${this.img})`,this.htmlElement.className="itemObject",this.htmlElement.addEventListener("click",(t=>{t.preventDefault(),window.dispatchEvent(new R(this.item))}))}}class J extends Event{constructor(t){super("sceneChange",{cancelable:!0}),this.sceneRef=t}}class q extends z{constructor(t,e,i,s,n){super(t,e,i,s),this.to=n}setup(){this.htmlElement.style.position="absolute",this.htmlElement.style.cursor="pointer",this.htmlElement.style.right=`${this.x}%`,this.htmlElement.style.top=`${this.y}%`,this.htmlElement.style.width=`${this.width}vw`,this.htmlElement.style.height=`${this.height}vh`,this.htmlElement.className="pathObject",this.htmlElement.addEventListener("click",(t=>{t.preventDefault(),window.dispatchEvent(new J(this.to))}))}}var F,K,Q,U,V,X=function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)},Y=function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i};class Z{constructor(t,e,i,s,n){F.add(this),K.set(this,void 0),Q.set(this,void 0),this.id=t,this.background=e,this.paths=i,this.items=s,this.hint=n||"",this.hintShouldBeDisplayed=Boolean(n),Y(this,K,X(this,F,"m",U).call(this),"f"),Y(this,Q,X(this,F,"m",V).call(this),"f")}removeItem(t,e){var i,s;const n=null===(i=X(this,Q,"f"))||void 0===i?void 0:i.find((e=>e.item===t));if(!n)return;e.removeChild(n.htmlElement);const a=null===(s=X(this,Q,"f"))||void 0===s?void 0:s.indexOf(n),r=JSON.parse(JSON.stringify(X(this,Q,"f")));r.splice(a,1),Y(this,Q,r,"f")}checkItemArrayEmpty(t){return!t||t.length<=0}clear(t){X(this,K,"f").forEach((e=>{e.clear(t)})),this.checkItemArrayEmpty(X(this,Q,"f"))||X(this,Q,"f").forEach((e=>{console.log(e),t.contains(e.htmlElement)&&e.clear(t)}))}draw(t){X(this,K,"f").forEach((e=>{t.appendChild(e.htmlElement)})),X(this,Q,"f")&&X(this,Q,"f").forEach((e=>{t.appendChild(e.htmlElement)}))}}K=new WeakMap,Q=new WeakMap,F=new WeakSet,U=function(){const t=[];return this.paths.forEach((e=>{const i=new q(e.x,e.y,e.width,e.height,e.to);i.setup(),t.push(i)})),t},V=function(){if(this.checkItemArrayEmpty(this.items))return[];console.log("items",this.items);const t=[];return this.items.forEach((e=>{const i=new A(e.x,e.y,e.width,e.height,e.item,e.img);i.setup(),t.push(i)})),console.log("newItems",Object.assign({},t)),t};var tt,et,it,st,nt,at,rt,ot,ht=function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i},lt=function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)};class ct{constructor(e){tt.add(this),et.set(this,void 0),it.set(this,void 0),st.set(this,void 0),nt.set(this,void 0),ht(this,et,new t("Marc"),"f"),ht(this,it,e,"f"),ht(this,st,new k(e,lt(this,et,"f"),lt(this,tt,"m",at).call(this)),"f")}init(){console.log("player",lt(this,et,"f")),lt(this,tt,"m",rt).call(this),window.addEventListener("gameStart",(t=>{t.preventDefault(),lt(this,nt,"f").clear(),lt(this,tt,"m",ot).call(this)}))}}et=new WeakMap,it=new WeakMap,st=new WeakMap,nt=new WeakMap,tt=new WeakSet,at=function(){return G.N.map((t=>new Z(t.id,t.background,t.paths,t.items||[],t.hint||"")))},rt=function(){ht(this,nt,new _("https://img.freepik.com/free-vector/colorful-palm-silhouettes-background_23-2148541792.jpg?w=2000","Test Message",lt(this,it,"f")),"f"),lt(this,nt,"f").draw()},ot=function(){lt(this,st,"f").start()},window.addEventListener("load",(()=>{const[t,e]=function(){const t=document.getElementById("main")||document.createElement("main");"main"!==t.id&&(t.id="main");const e=document.getElementById("overlay")||document.createElement("div");return"overlay"!==e.id&&(e.id="overlay"),[t,e]}();!function(t,e){const i=window.innerHeight>window.innerWidth;let s=!1;i?null==e||e.style.setProperty("display","block"):(null==e||e.style.setProperty("display","none"),t.init(),s=!0),window.addEventListener("resize",(i=>{window.innerHeight>window.innerWidth?null==e||e.style.setProperty("display","block"):(null==e||e.style.setProperty("display","none"),s||(t.init(),s=!0))}))}(new ct(t),e)}))})();